(()=>{var e={55481:(e,t,n)=>{"use strict";var r=n(14224);const i=/[\u001b\u009b][[\]#;?()]*(?:(?:(?:[^\W_]*;?[^\W_]*)\u0007)|(?:(?:[0-9]{1,4}(;[0-9]{0,4})*)?[~0-9=<>cf-nqrtyA-PRZ]))/g,o=()=>{const e={enabled:void 0!==r&&"0"!==r.env.FORCE_COLOR,visible:!0,styles:{},keys:{}},t=(e,t,n)=>"function"==typeof e?e(t):e.wrap(t,n),o=(n,r)=>{if(""===n||null==n)return"";if(!1===e.enabled)return n;if(!1===e.visible)return"";let i=""+n,o=i.includes("\n"),s=r.length;for(s>0&&r.includes("unstyle")&&(r=[...new Set(["unstyle",...r])].reverse());s-- >0;)i=t(e.styles[r[s]],i,o);return i},s=(t,n,r)=>{e.styles[t]=(e=>{let t=e.open=`[${e.codes[0]}m`,n=e.close=`[${e.codes[1]}m`,r=e.regex=new RegExp(`\\u001b\\[${e.codes[1]}m`,"g");return e.wrap=(e,i)=>{e.includes(n)&&(e=e.replace(r,n+t));let o=t+e+n;return i?o.replace(/\r*\n/g,`${n}$&${t}`):o},e})({name:t,codes:n}),(e.keys[r]||(e.keys[r]=[])).push(t),Reflect.defineProperty(e,t,{configurable:!0,enumerable:!0,set(n){e.alias(t,n)},get(){let n=e=>o(e,n.stack);return Reflect.setPrototypeOf(n,e),n.stack=this.stack?this.stack.concat(t):[t],n}})};return s("reset",[0,0],"modifier"),s("bold",[1,22],"modifier"),s("dim",[2,22],"modifier"),s("italic",[3,23],"modifier"),s("underline",[4,24],"modifier"),s("inverse",[7,27],"modifier"),s("hidden",[8,28],"modifier"),s("strikethrough",[9,29],"modifier"),s("black",[30,39],"color"),s("red",[31,39],"color"),s("green",[32,39],"color"),s("yellow",[33,39],"color"),s("blue",[34,39],"color"),s("magenta",[35,39],"color"),s("cyan",[36,39],"color"),s("white",[37,39],"color"),s("gray",[90,39],"color"),s("grey",[90,39],"color"),s("bgBlack",[40,49],"bg"),s("bgRed",[41,49],"bg"),s("bgGreen",[42,49],"bg"),s("bgYellow",[43,49],"bg"),s("bgBlue",[44,49],"bg"),s("bgMagenta",[45,49],"bg"),s("bgCyan",[46,49],"bg"),s("bgWhite",[47,49],"bg"),s("blackBright",[90,39],"bright"),s("redBright",[91,39],"bright"),s("greenBright",[92,39],"bright"),s("yellowBright",[93,39],"bright"),s("blueBright",[94,39],"bright"),s("magentaBright",[95,39],"bright"),s("cyanBright",[96,39],"bright"),s("whiteBright",[97,39],"bright"),s("bgBlackBright",[100,49],"bgBright"),s("bgRedBright",[101,49],"bgBright"),s("bgGreenBright",[102,49],"bgBright"),s("bgYellowBright",[103,49],"bgBright"),s("bgBlueBright",[104,49],"bgBright"),s("bgMagentaBright",[105,49],"bgBright"),s("bgCyanBright",[106,49],"bgBright"),s("bgWhiteBright",[107,49],"bgBright"),e.ansiRegex=i,e.hasColor=e.hasAnsi=t=>(e.ansiRegex.lastIndex=0,"string"==typeof t&&""!==t&&e.ansiRegex.test(t)),e.alias=(t,n)=>{let r="string"==typeof n?e[n]:n;if("function"!=typeof r)throw new TypeError("Expected alias to be the name of an existing color (string) or a function");r.stack||(Reflect.defineProperty(r,"name",{value:t}),e.styles[t]=r,r.stack=[t]),Reflect.defineProperty(e,t,{configurable:!0,enumerable:!0,set(n){e.alias(t,n)},get(){let t=e=>o(e,t.stack);return Reflect.setPrototypeOf(t,e),t.stack=this.stack?this.stack.concat(r.stack):r.stack,t}})},e.theme=t=>{if(null===(n=t)||"object"!=typeof n||Array.isArray(n))throw new TypeError("Expected theme to be an object");var n;for(let n of Object.keys(t))e.alias(n,t[n]);return e},e.alias("unstyle",(t=>"string"==typeof t&&""!==t?(e.ansiRegex.lastIndex=0,t.replace(e.ansiRegex,"")):"")),e.alias("noop",(e=>e)),e.none=e.clear=e.noop,e.stripColor=e.unstyle,e.symbols=n(66394),e.define=s,e};e.exports=o(),e.exports.create=o},66394:(e,t,n)=>{"use strict";var r=n(14224);const i=void 0!==r&&"Hyper"===r.env.TERM_PROGRAM,o=void 0!==r&&"win32"===r.platform,s=void 0!==r&&"linux"===r.platform,a={ballotDisabled:"â˜’",ballotOff:"â˜",ballotOn:"â˜‘",bullet:"â€¢",bulletWhite:"â—¦",fullBlock:"â–ˆ",heart:"â¤",identicalTo:"â‰¡",line:"â”€",mark:"â€»",middot:"Â·",minus:"ï¼",multiplication:"Ã—",obelus:"Ã·",pencilDownRight:"âœŽ",pencilRight:"âœ",pencilUpRight:"âœ",percent:"%",pilcrow2:"â¡",pilcrow:"Â¶",plusMinus:"Â±",question:"?",section:"Â§",starsOff:"â˜†",starsOn:"â˜…",upDownArrow:"â†•"},c=Object.assign({},a,{check:"âˆš",cross:"Ã—",ellipsisLarge:"...",ellipsis:"...",info:"i",questionSmall:"?",pointer:">",pointerSmall:"Â»",radioOff:"( )",radioOn:"(*)",warning:"â€¼"}),l=Object.assign({},a,{ballotCross:"âœ˜",check:"âœ”",cross:"âœ–",ellipsisLarge:"â‹¯",ellipsis:"â€¦",info:"â„¹",questionFull:"ï¼Ÿ",questionSmall:"ï¹–",pointer:s?"â–¸":"â¯",pointerSmall:s?"â€£":"â€º",radioOff:"â—¯",radioOn:"â—‰",warning:"âš "});e.exports=o&&!i?c:l,Reflect.defineProperty(e.exports,"common",{enumerable:!1,value:a}),Reflect.defineProperty(e.exports,"windows",{enumerable:!1,value:c}),Reflect.defineProperty(e.exports,"other",{enumerable:!1,value:l})},94654:(e,t,n)=>{var r=n(14224);const i=Symbol("arg flag");class o extends Error{constructor(e,t){super(e),this.name="ArgError",this.code=t,Object.setPrototypeOf(this,o.prototype)}}function s(e,{argv:t=r.argv.slice(2),permissive:n=!1,stopAtPositional:s=!1}={}){if(!e)throw new o("argument specification object is required","ARG_CONFIG_NO_SPEC");const a={_:[]},c={},l={};for(const t of Object.keys(e)){if(!t)throw new o("argument key cannot be an empty string","ARG_CONFIG_EMPTY_KEY");if("-"!==t[0])throw new o(`argument key must start with '-' but found: '${t}'`,"ARG_CONFIG_NONOPT_KEY");if(1===t.length)throw new o(`argument key must have a name; singular '-' keys are not allowed: ${t}`,"ARG_CONFIG_NONAME_KEY");if("string"==typeof e[t]){c[t]=e[t];continue}let n=e[t],r=!1;if(Array.isArray(n)&&1===n.length&&"function"==typeof n[0]){const[e]=n;n=(t,n,r=[])=>(r.push(e(t,n,r[r.length-1])),r),r=e===Boolean||!0===e[i]}else{if("function"!=typeof n)throw new o(`type missing or not a function or valid array type: ${t}`,"ARG_CONFIG_VAD_TYPE");r=n===Boolean||!0===n[i]}if("-"!==t[1]&&t.length>2)throw new o(`short argument keys (with a single hyphen) must have only one character: ${t}`,"ARG_CONFIG_SHORTOPT_TOOLONG");l[t]=[n,r]}for(let e=0,r=t.length;e<r;e++){const r=t[e];if(s&&a._.length>0){a._=a._.concat(t.slice(e));break}if("--"===r){a._=a._.concat(t.slice(e+1));break}if(r.length>1&&"-"===r[0]){const i="-"===r[1]||2===r.length?[r]:r.slice(1).split("").map((e=>`-${e}`));for(let r=0;r<i.length;r++){const s=i[r],[h,u]="-"===s[1]?s.split(/=(.*)/,2):[s,void 0];let d=h;for(;d in c;)d=c[d];if(!(d in l)){if(n){a._.push(s);continue}throw new o(`unknown or unexpected option: ${h}`,"ARG_UNKNOWN_OPTION")}const[p,f]=l[d];if(!f&&r+1<i.length)throw new o(`option requires argument (but was followed by another short argument): ${h}`,"ARG_MISSING_REQUIRED_SHORTARG");if(f)a[d]=p(!0,d,a[d]);else if(void 0===u){if(t.length<e+2||t[e+1].length>1&&"-"===t[e+1][0]&&(!t[e+1].match(/^-?\d*(\.(?=\d))?\d*$/)||p!==Number&&("undefined"==typeof BigInt||p!==BigInt)))throw new o(`option requires argument: ${h}${h===d?"":` (alias for ${d})`}`,"ARG_MISSING_REQUIRED_LONGARG");a[d]=p(t[e+1],d,a[d]),++e}else a[d]=p(u,d,a[d])}}else a._.push(r)}return a}s.flag=e=>(e[i]=!0,e),s.COUNT=s.flag(((e,t,n)=>(n||0)+1)),s.ArgError=o,e.exports=s},96656:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(62568),i=n.n(r),o=n(68802),s=n.n(o)()(i());s.push([e.id,".IXur10FyYhrkjdvL3YJP {\r\n  margin: 0;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.Nxb7VY3RhqzBAaj_3s8J {\r\n  height: 90%;\r\n  overflow: auto;\r\n  background-color: #121212;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.MhcT1i3sp9dBktHySC03 {\r\n  display: flex;\r\n}\r\n\r\n.qrJhI8vNNSz0qaxx22_Q {\r\n  font-size: 2rem;\r\n  width: 90%;\r\n  color: initial;\r\n}\r\n\r\n.aabZYBE305DiKzB6h3IU {\r\n  font-weight: bolder;\r\n  width: 10%;\r\n  background-color: #121212;\r\n  color: white;\r\n}\r\n\r\n.nL1fGx34jqk7g144uRHx, .MMWAN9tEXWurIiikyhFR {\r\n  position: relative;\r\n  padding: 1rem;\r\n  border-radius: 20px;\r\n  max-width: 30%;\r\n  min-width: 10ch;\r\n  margin: 1rem;\r\n  word-wrap: break-word;\r\n}\r\n\r\n.nL1fGx34jqk7g144uRHx {\r\n  background-color: #00aabb;\r\n  align-self: flex-start;\r\n}\r\n\r\n.MMWAN9tEXWurIiikyhFR {\r\n  background-color: #00bd26;\r\n  align-self: flex-end;\r\n}\r\n\r\n.nL1fGx34jqk7g144uRHx:after, .MMWAN9tEXWurIiikyhFR:after {\r\n  content: '';\r\n\tposition: absolute;\r\n\tbottom: 0;\r\n\tleft: 50%;\r\n\twidth: 0;\r\n\theight: 0;\r\n\tborder: 20px solid transparent;\r\n  border-bottom: 0;\r\n\tmargin-left: -10px;\r\n\tmargin-bottom: -20px;\r\n}\r\n\r\n.nL1fGx34jqk7g144uRHx:after {\r\n\tborder-top-color: #00aabb;\r\n  border-left: 0;\r\n}\r\n\r\n.MMWAN9tEXWurIiikyhFR:after {\r\n\tborder-top-color: #00bd26;\r\n  border-right: 0;\r\n}\r\n","",{version:3,sources:["webpack://./src/modules/peer/peer.module.css"],names:[],mappings:"AAAA;EACE,SAAS;EACT,YAAY;EACZ,aAAa;EACb,sBAAsB;AACxB;;AAEA;EACE,WAAW;EACX,cAAc;EACd,yBAAyB;EACzB,aAAa;EACb,sBAAsB;AACxB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,eAAe;EACf,UAAU;EACV,cAAc;AAChB;;AAEA;EACE,mBAAmB;EACnB,UAAU;EACV,yBAAyB;EACzB,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,aAAa;EACb,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,YAAY;EACZ,qBAAqB;AACvB;;AAEA;EACE,yBAAyB;EACzB,sBAAsB;AACxB;;AAEA;EACE,yBAAyB;EACzB,oBAAoB;AACtB;;AAEA;EACE,WAAW;CACZ,kBAAkB;CAClB,SAAS;CACT,SAAS;CACT,QAAQ;CACR,SAAS;CACT,8BAA8B;EAC7B,gBAAgB;CACjB,kBAAkB;CAClB,oBAAoB;AACrB;;AAEA;CACC,yBAAyB;EACxB,cAAc;AAChB;;AAEA;CACC,yBAAyB;EACxB,eAAe;AACjB",sourcesContent:[".container {\r\n  margin: 0;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.chat {\r\n  height: 90%;\r\n  overflow: auto;\r\n  background-color: #121212;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.form {\r\n  display: flex;\r\n}\r\n\r\n.input {\r\n  font-size: 2rem;\r\n  width: 90%;\r\n  color: initial;\r\n}\r\n\r\n.button {\r\n  font-weight: bolder;\r\n  width: 10%;\r\n  background-color: #121212;\r\n  color: white;\r\n}\r\n\r\n.toMe, .fromMe {\r\n  position: relative;\r\n  padding: 1rem;\r\n  border-radius: 20px;\r\n  max-width: 30%;\r\n  min-width: 10ch;\r\n  margin: 1rem;\r\n  word-wrap: break-word;\r\n}\r\n\r\n.toMe {\r\n  background-color: #00aabb;\r\n  align-self: flex-start;\r\n}\r\n\r\n.fromMe {\r\n  background-color: #00bd26;\r\n  align-self: flex-end;\r\n}\r\n\r\n.toMe:after, .fromMe:after {\r\n  content: '';\r\n\tposition: absolute;\r\n\tbottom: 0;\r\n\tleft: 50%;\r\n\twidth: 0;\r\n\theight: 0;\r\n\tborder: 20px solid transparent;\r\n  border-bottom: 0;\r\n\tmargin-left: -10px;\r\n\tmargin-bottom: -20px;\r\n}\r\n\r\n.toMe:after {\r\n\tborder-top-color: #00aabb;\r\n  border-left: 0;\r\n}\r\n\r\n.fromMe:after {\r\n\tborder-top-color: #00bd26;\r\n  border-right: 0;\r\n}\r\n"],sourceRoot:""}]),s.locals={container:"IXur10FyYhrkjdvL3YJP",chat:"Nxb7VY3RhqzBAaj_3s8J",form:"MhcT1i3sp9dBktHySC03",input:"qrJhI8vNNSz0qaxx22_Q",button:"aabZYBE305DiKzB6h3IU",toMe:"nL1fGx34jqk7g144uRHx",fromMe:"MMWAN9tEXWurIiikyhFR"};const a=s},68802:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var l=0;l<e.length;l++){var h=[].concat(e[l]);r&&s[h[0]]||(void 0!==o&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=o),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),i&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=i):h[4]="".concat(i)),t.push(h))}},t}},62568:e=>{"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),o="/*# ".concat(i," */"),s=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[t].concat(s).concat([o]).join("\n")}return[t].join("\n")}},18238:(e,t,n)=>{"use strict";var r=Object.create,i=Object.defineProperty,o=Object.defineProperties,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,p=(e,t,n)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f=(e,t)=>{for(var n in t||(t={}))u.call(t,n)&&p(e,n,t[n]);if(l)for(var n of l(t))d.call(t,n)&&p(e,n,t[n]);return e},g=(e,t)=>o(e,a(t)),_=(e,t)=>function(){return t||(0,e[c(e)[0]])((t={exports:{}}).exports,t),t.exports},b=(e,t)=>{return((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of c(t))u.call(e,n)||"default"===n||i(e,n,{get:()=>t[n],enumerable:!(r=s(t,n))||r.enumerable});return e})((n=i(null!=e?r(h(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0}),i(n,"__esModule",{value:!0})),e);var n},y=(e,t,n)=>new Promise(((r,i)=>{var o=e=>{try{a(n.next(e))}catch(e){i(e)}},s=e=>{try{a(n.throw(e))}catch(e){i(e)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);a((n=n.apply(e,t)).next())})),m=_({"node_modules/peerjs-js-binarypack/lib/bufferbuilder.js"(e,t){var n={};n.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),n.useArrayBufferView=!n.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=n;var r=t.exports.BlobBuilder;function i(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(r=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),i.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},i.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);n.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},i.prototype.getBuffer=function(){if(this.flush(),n.useBlobBuilder){for(var e=new r,t=0,i=this._parts.length;t<i;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=i}}),v=_({"node_modules/peerjs-js-binarypack/lib/binarypack.js"(e,t){var n=m().BufferBuilder,r=m().binaryFeatures,i={unpack:function(e){return new o(e).unpack()},pack:function(e){var t=new s;return t.pack(e),t.getBuffer()}};function o(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function s(){this.bufferBuilder=new n}function a(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=i,o.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:case 212:case 213:case 214:case 215:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},o.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},o.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},o.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},o.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},o.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},o.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},o.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},o.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},o.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},o.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),i=0,o="";i<e;)(t=r[i])<128?(o+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=e,o},o.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},o.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},o.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},o.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},o.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},s.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},s.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)r.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)r.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},s.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,a).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},s.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},s.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),s=t<<31|n+1023<<20|i/o&1048575,a=i%o;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},s.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},s.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},s.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},s.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},s.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},s.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}}}),w=_({"node_modules/eventemitter3/index.js"(e,t){var n=Object.prototype.hasOwnProperty,r="~";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new o(n,i||e,s),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function c(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),c.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)n.call(e,t)&&i.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},c.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},c.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var c,l,h=this._events[a],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,n),!0;case 4:return h.fn.call(h.context,t,n,i),!0;case 5:return h.fn.call(h.context,t,n,i,o),!0;case 6:return h.fn.call(h.context,t,n,i,o,s),!0}for(l=1,c=new Array(u-1);l<u;l++)c[l-1]=arguments[l];h.fn.apply(h.context,c)}else{var d,p=h.length;for(l=0;l<p;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),u){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,n);break;case 4:h[l].fn.call(h[l].context,t,n,i);break;default:if(!c)for(d=1,c=new Array(u-1);d<u;d++)c[d-1]=arguments[d];h[l].fn.apply(h[l].context,c)}}return!0},c.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var c=0,l=[],h=s.length;c<h;c++)(s[c].fn!==t||i&&!s[c].once||n&&s[c].context!==n)&&l.push(s[c]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,void 0!==t&&(t.exports=c)}}),k=b(v()),A={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"},C=new class{constructor(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedMTU=16300,this.defaultConfig=A,this.pack=k.pack,this.unpack=k.unpack,this._dataCount=1}validateId(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)}chunk(e){const t=[],n=e.size,r=Math.ceil(n/C.chunkedMTU);let i=0,o=0;for(;o<n;){const s=Math.min(n,o+C.chunkedMTU),a=e.slice(o,s),c={__peerData:this._dataCount,n:i,data:a,total:r};t.push(c),o=s,i++}return this._dataCount++,t}blobToArrayBuffer(e,t,n){const r=new e;return r.onload=function(e){e.target&&n(e.target.result)},r.readAsArrayBuffer(t),r}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer}randomToken(){return Math.random().toString(36).substr(2)}isSecure(){return"https:"===location.protocol}},B=b(w()),E=new class{constructor(){this._logLevel=0}get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const n=["PeerJS: ",...t];for(let e in n)n[e]instanceof Error&&(n[e]="("+n[e].name+") "+n[e].message);e>=3?console.log(...n):e>=2?console.warn("WARNING",...n):e>=1&&console.error("ERROR",...n)}},S=b(w()),x=class extends S.EventEmitter{constructor({secure:e,host:t,port:n,path:r,key:i,pingInterval:o=5e3,polyfills:s}){var a;super(),this._disconnected=!0,this._id=null,this._messagesQueue=[],this.alive=!1,this._destroyed=!1,this.pingInterval=o;const c=e?"wss://":"ws://";this._baseUrl=c+t+":"+n+r+"peerjs?key="+i,this.WebSocketConstructor=null!=(a=null==s?void 0:s.WebSocket)?a:window.WebSocket}get messagesQueue(){return this._messagesQueue}get destroyed(){return this._destroyed}start(e,t){if(this._destroyed)throw new Error("Socket was destroyed!");if(this._id=e,this._socket||!this._disconnected)return;const n=`${this._baseUrl}&id=${e}&token=${t}`;this._socket=new this.WebSocketConstructor(n),this._disconnected=!1,this._socket.onmessage=e=>{if(this._destroyed)return;let t;try{t=JSON.parse(e.data),E.log("Server message received:",t)}catch(t){return void E.log("Invalid server message",e.data)}this.emit("message",t)},this._socket.onclose=e=>{this._disconnected||this._destroyed||(E.log("Socket closed.",e),this._cleanup(),this._disconnected=!0,this.emit("disconnected"))},this._socket.onopen=()=>{this._disconnected||this._destroyed||(E.log("Socket open"),this.emit("open"),this._sendQueuedMessages(),this._scheduleHeartbeat())}}_scheduleHeartbeat(){this._wsPingTimer=setTimeout((()=>{this._sendHeartbeat()}),this.pingInterval)}_sendHeartbeat(){if(this._destroyed)return;if(!this._wsOpen())return void E.log("Cannot send heartbeat, because socket closed");const e=JSON.stringify({type:"HEARTBEAT"});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&1===this._socket.readyState}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t);e.length>0&&E.log(`${e.length} queued messages was sent`)}send(e){if(this._destroyed)throw new Error("Socket was destroyed!");if(!e.type)return void this.emit("error","Invalid message");if(!this.alive)return;if(null==this._id||!this._wsOpen())return void this._messagesQueue.push(e);const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._id=null,this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}destroy(){this._destroyed||(this.close(),this._messagesQueue.length=0,this._destroyed=!0)}};function T(){}var I=class{constructor(e){this.connection=e}get webRtc(){var e,t;return null!=(t=null==(e=this.connection.provider.options.polyfills)?void 0:e.WebRTC)?t:window}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,"media"===this.connection.type&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if("data"===this.connection.type){const n=this.connection,r={ordered:!!e.reliable},i=t.createDataChannel(n.label,r);n.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){E.log("Creating RTCPeerConnection.");const e=new(0,this.webRtc.RTCPeerConnection)(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,n=this.connection.connectionId,r=this.connection.type,i=this.connection.provider;E.log("Listening for ICE candidates, remote streams and data channels."),e.onicecandidate=e=>{e.candidate&&e.candidate.candidate&&(E.log(`Received ICE candidates for ${t}:`,e.candidate),i.socket.send({type:"CANDIDATE",payload:{candidate:e.candidate,type:r,connectionId:n},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":E.log("iceConnectionState is failed, closing connections to "+t),this.connection.emit("error",new Error("Negotiation of connection to "+t+" failed.")),this.connection.close();break;case"closed":E.log("iceConnectionState is closed, closing connections to "+t),this.connection.emit("error",new Error("Connection to "+t+" closed.")),this.connection.close();break;case"connected":E.log("iceConnectionState changed to connected on the connection with "+t);break;case"disconnected":E.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":E.log("iceConnectionState changed to completed on the connection with "+t),e.onicecandidate=T}this.connection.emit("iceStateChanged",e.iceConnectionState)},e.ondatachannel=e=>{E.log("Received data channel");const r=e.channel;i.getConnection(t,n).initialize(r)},e.ontrack=e=>{E.log("Received remote stream");const r=e.streams[0],o=i.getConnection(t,n);if("media"===o.type){const e=o;this._addStreamToMediaConnection(r,e)}}}cleanup(){E.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=null;const t="closed"!==e.signalingState;let n=!1;if("data"===this.connection.type){const e=this.connection.dataChannel;e&&(n=!!e.readyState&&"closed"!==e.readyState)}(t||n)&&e.close()}_makeOffer(){return y(this,null,(function*(){const e=this.connection.peerConnection,t=this.connection.provider;try{const n=yield e.createOffer(this.connection.options.constraints);if("closed"===e.signalingState)return;E.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{yield e.setLocalDescription(n),E.log("Set localDescription:",n,`for:${this.connection.peer}`);let r={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if("data"===this.connection.type){const e=this.connection;r=g(f({},r),{label:e.label,reliable:e.reliable,serialization:e.serialization})}t.socket.send({type:"OFFER",payload:r,dst:this.connection.peer})}catch(e){"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=e&&(t.emitError("webrtc",e),E.log("Failed to setLocalDescription, ",e))}}catch(e){t.emitError("webrtc",e),E.log("Failed to createOffer, ",e)}}))}_makeAnswer(){return y(this,null,(function*(){const e=this.connection.peerConnection,t=this.connection.provider;try{const n=yield e.createAnswer();if("closed"===e.signalingState)return;E.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{yield e.setLocalDescription(n),E.log("Set localDescription:",n,`for:${this.connection.peer}`),t.socket.send({type:"ANSWER",payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(e){t.emitError("webrtc",e),E.log("Failed to setLocalDescription, ",e)}}catch(e){t.emitError("webrtc",e),E.log("Failed to create answer, ",e)}}))}handleSDP(e,t){return y(this,null,(function*(){const n=this.webRtc.RTCSessionDescription;t=new n(t);const r=this.connection.peerConnection,i=this.connection.provider;E.log("Setting remote description",t);const o=this;try{yield r.setRemoteDescription(t),E.log(`Set remoteDescription:${e} for:${this.connection.peer}`),"OFFER"===e&&(yield o._makeAnswer())}catch(e){i.emitError("webrtc",e),E.log("Failed to setRemoteDescription, ",e)}}))}handleCandidate(e){return y(this,null,(function*(){E.log("handleCandidate:",e);const t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,i=this.connection.peerConnection,o=this.connection.provider;try{const e=this.webRtc.RTCIceCandidate;yield i.addIceCandidate(new e({sdpMid:r,sdpMLineIndex:n,candidate:t})),E.log(`Added ICE candidate for:${this.connection.peer}`)}catch(e){o.emitError("webrtc",e),E.log("Failed to handleCandidate, ",e)}}))}_addTracksToConnection(e,t){if(E.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return E.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((n=>{t.addTrack(n,e)}))}_addStreamToMediaConnection(e,t){E.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}},R=b(w()),O=class extends R.EventEmitter{constructor(e,t,n){super(),this.peer=e,this.provider=t,this.options=n,this._open=!1,this.metadata=n.metadata}get open(){return this._open}},M=class extends O{get type(){return"media"}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,n){super(e,t,n),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||M.ID_PREFIX+C.randomToken(),this._negotiator=new I(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}addStream(e){E.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,n=e.payload;switch(e.type){case"ANSWER":this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case"CANDIDATE":this._negotiator.handleCandidate(n.candidate);break;default:E.warn(`Unrecognized message type:${t} from peer:${this.peer}`)}}answer(e,t={}){if(this._localStream)return void E.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(g(f({},this.options._payload),{_stream:e}));const n=this.provider._getMessages(this.connectionId);for(let e of n)this.handleMessage(e);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}},P=M;P.ID_PREFIX="mc_";var D=b(w()),j=class extends D.EventEmitter{constructor(e){super(),this.fileReader=e,this._queue=[],this._processing=!1,this.fileReader.onload=e=>{this._processing=!1,e.target&&this.emit("done",e.target.result),this.doNextTask()},this.fileReader.onerror=e=>{E.error("EncodingQueue error:",e),this._processing=!1,this.destroy(),this.emit("error",e)}}get queue(){return this._queue}get size(){return this.queue.length}get processing(){return this._processing}enque(e){this.queue.push(e),this.processing||this.doNextTask()}destroy(){this.fileReader.abort(),this._queue=[]}doNextTask(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))}},L=class extends O{constructor(e,t,n){var r,i;super(e,t,n),this.stringify=JSON.stringify,this.parse=JSON.parse,this._buffer=[],this._bufferSize=0,this._buffering=!1,this._chunkedData={},this.connectionId=this.options.connectionId||L.ID_PREFIX+C.randomToken(),this.label=this.options.label||this.connectionId,this.serialization=this.options.serialization||"binary",this.reliable=!!this.options.reliable,this.FileReaderCtr=null!=(i=null==(r=t.options.polyfills)?void 0:r.FileReader)?i:window.FileReader,this._encodingQueue=new j(new this.FileReaderCtr),this._encodingQueue.on("done",(e=>{this._bufferedSend(e)})),this._encodingQueue.on("error",(()=>{E.error(`DC#${this.connectionId}: Error occured in encoding from blob to arraybuffer, close DC`),this.close()})),this._negotiator=new I(this),this._negotiator.startConnection(this.options._payload||{originator:!0})}get type(){return"data"}get dataChannel(){return this._dc}get bufferSize(){return this._bufferSize}initialize(e){this._dc=e,this._configureDataChannel()}_configureDataChannel(){this.provider.features.binaryBlob&&!this.provider.features.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=()=>{E.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=e=>{E.log(`DC#${this.connectionId} dc onmessage:`,e.data),this._handleDataMessage(e)},this.dataChannel.onclose=()=>{E.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}_handleDataMessage({data:e}){const t=e.constructor;let n=e;if("binary"===this.serialization||"binary-utf8"===this.serialization){if(t===Blob)return void C.blobToArrayBuffer(this.FileReaderCtr,e,(e=>{const t=C.unpack(e);this.emit("data",t)}));if(t===ArrayBuffer)n=C.unpack(e);else if(t===String){const t=C.binaryStringToArrayBuffer(e);n=C.unpack(t)}}else"json"===this.serialization&&(n=this.parse(e));n.__peerData?this._handleChunk(n):super.emit("data",n)}_handleChunk(e){const t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];const e=new Blob(n.data);this._handleDataMessage({data:e})}}close(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t){if(this.open)if("json"===this.serialization)this._bufferedSend(this.stringify(e));else if("binary"===this.serialization||"binary-utf8"===this.serialization){const n=C.pack(e);if(!t&&n.size>C.chunkedMTU)return void this._sendChunks(n);this.provider.features.binaryBlob?this._bufferedSend(n):this._encodingQueue.enque(n)}else this._bufferedSend(e);else super.emit("error",new Error("Connection is not open. You should listen for the `open` event before sending messages."))}_bufferedSend(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>L.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((()=>{this._buffering=!1,this._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return E.error(`DC#:${this.connectionId} Error when sending:`,e),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open)return;if(0===this._buffer.length)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}_sendChunks(e){const t=C.chunk(e);E.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(let e of t)this.send(e,!0)}handleMessage(e){const t=e.payload;switch(e.type){case"ANSWER":this._negotiator.handleSDP(e.type,t.sdp);break;case"CANDIDATE":this._negotiator.handleCandidate(t.candidate);break;default:E.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}}},N=L;N.ID_PREFIX="dc_",N.MAX_BUFFERED_AMOUNT=8388608;var F={isUnifiedPlanSupported(e){if(e||"undefined"==typeof window||(e=window),void 0===e.RTCRtpTransceiver||!("currentDirection"in e.RTCRtpTransceiver.prototype))return!1;let t,n=!1;try{t=new e.RTCPeerConnection,t.addTransceiver("audio"),n=!0}catch(e){}finally{t&&t.close()}return n}},$=class extends B.EventEmitter{constructor(e,t){var n;let r;super(),this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map,e&&e.constructor==Object?t=e:e&&(r=e.toString()),t=f({debug:0,host:C.CLOUD_HOST,port:C.CLOUD_PORT,path:"/",key:$.DEFAULT_KEY,token:C.randomToken(),config:C.defaultConfig},t),this._options=t,"undefined"!=typeof window&&"/"===this._options.host&&(this._options.host=window.location.hostname),this._options.path&&("/"!==this._options.path[0]&&(this._options.path="/"+this._options.path),"/"!==this._options.path[this._options.path.length-1]&&(this._options.path+="/")),void 0===this._options.secure&&this._options.host!==C.CLOUD_HOST?this._options.secure=C.isSecure():this._options.host==C.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&E.setLogFunction(this._options.logFunction),E.logLevel=this._options.debug||0,this._api=new class{constructor(e){this._options=e}_request(e){var t,n;return(null!=(n=null==(t=this._options.polyfills)?void 0:t.fetch)?n:window.fetch)(e)}_buildUrl(e){let t=(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e;return t+="?ts="+(new Date).getTime()+Math.random(),t}retrieveId(){return y(this,null,(function*(){const e=this._buildUrl("id");try{const t=yield this._request(e);if(200!==t.status)throw new Error(`Error. Status:${t.status}`);return t.text()}catch(e){E.error("Error retrieving ID",e);let t="";throw"/"===this._options.path&&this._options.host!==C.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}))}listAllPeers(){return y(this,null,(function*(){const e=this._buildUrl("peers");try{const t=yield this._request(e);if(200!==t.status){if(401===t.status){let e="";throw e=this._options.host===C.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+e)}throw new Error(`Error. Status:${t.status}`)}return t.json()}catch(e){throw E.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}))}}(t),this._socket=this._createServerConnection(),this.features=$.getFeatures(null==(n=this._options.polyfills)?void 0:n.WebRTC),this.features.audioVideo||this.features.data?!r||C.validateId(r)?(this.socket.alive=!0,r?this._initialize(r):this._api.retrieveId().then((e=>this._initialize(e))).catch((e=>this._abort("server-error",e)))):this._delayedAbort("invalid-id",`ID "${r}" is invalid`):this._delayedAbort("browser-incompatible","The current browser does not support WebRTC")}get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(let[t,n]of this._connections)e[t]=n;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}_createServerConnection(){const e=new x(this._options);return e.on("message",(e=>{this._handleMessage(e)})),e.on("error",(e=>{this._abort("socket-error",e)})),e.on("disconnected",(()=>{this.disconnected||(this.emitError("network","Lost connection to server."),this.disconnect())})),e.on("close",(()=>{this.disconnected||this._abort("socket-closed","Underlying socket is already closed.")})),e}_initialize(e){this.destroyed||(this._id=e,this.socket.start(e,this._options.token))}_handleMessage(e){const t=e.type,n=e.payload,r=e.src;switch(t){case"OPEN":this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case"ERROR":this._abort("server-error",n.msg);break;case"ID-TAKEN":this._abort("unavailable-id",`ID "${this.id}" is taken`);break;case"INVALID-KEY":this._abort("invalid-key",`API KEY "${this._options.key}" is invalid`);break;case"LEAVE":E.log(`Received leave message from ${r}`),this._cleanupPeer(r),this._connections.delete(r);break;case"EXPIRE":this.emitError("peer-unavailable",`Could not connect to peer ${r}`);break;case"OFFER":{const e=n.connectionId;let t=this.getConnection(r,e);if(t&&(t.close(),E.warn(`Offer received for existing Connection ID:${e}`)),"media"===n.type)t=new P(r,this,{connectionId:e,_payload:n,metadata:n.metadata}),this._addConnection(r,t),this.emit("call",t);else{if("data"!==n.type)return void E.warn(`Received malformed connection type:${n.type}`);t=new N(r,this,{connectionId:e,_payload:n,metadata:n.metadata,label:n.label,serialization:n.serialization,reliable:n.reliable}),this._addConnection(r,t),this.emit("connection",t)}const i=this._getMessages(e);for(let e of i)t.handleMessage(e);break}default:{if(!n)return void E.warn(`You received a malformed message from ${r} of type ${t}`);const i=n.connectionId,o=this.getConnection(r,i);o&&o.peerConnection?o.handleMessage(e):i?this._storeMessage(i,e):E.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(this.disconnected)return E.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");const n=new N(e,this,t);return this._addConnection(e,n),n}call(e,t,n={}){if(this.disconnected)return E.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");if(!t)return void E.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");n._stream=t;const r=new P(e,this,n);return this._addConnection(e,r),r}_addConnection(e,t){E.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const n=t.indexOf(e);-1!==n&&(t.splice(n,1),0===t.length&&this._connections.delete(e.peer))}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const n=this._connections.get(e);if(!n)return null;for(let e of n)if(e.connectionId===t)return e;return null}_delayedAbort(e,t){setTimeout((()=>{this._abort(e,t)}),0)}_abort(e,t){E.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}emitError(e,t){let n;E.error("Error:",t),n="string"==typeof t?new Error(t):t,n.type=e,this.emit("error",n)}destroy(){this.destroyed||(E.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this.socket.destroy(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(let e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(let e of t)e.close()}disconnect(){if(this.disconnected)return;const e=this.id;E.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.alive=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)E.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this.socket.alive=!0,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`);E.error("In a hurry? We're still trying to make the initial connection!")}}listAllPeers(e=(e=>{})){this._api.listAllPeers().then((t=>e(t))).catch((e=>this._abort("server-error",e)))}static getFeatures(e){return e||"undefined"==typeof window||(e=window),$._features||($._features=$.checkFeatures(e)),$._features}static checkFeatures(e){e||"undefined"==typeof window||(e=window);const t={webRTC:void 0!==e.RTCPeerConnection,audioVideo:!0,data:!1,binaryBlob:!1,reliable:!1,unifiedPlan:!1};if(!t.webRTC)return t;let n;try{let r;n=new e.RTCPeerConnection(C.defaultConfig);try{r=n.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!r.ordered;try{r.binaryType="blob",t.binaryBlob=!0}catch(e){}}catch(e){}finally{r&&r.close()}}catch(e){}finally{n&&n.close()}return t.unifiedPlan=F.isUnifiedPlanSupported(e),t}},U=$;U.DEFAULT_KEY="peerjs","undefined"!=typeof window&&(window.Peer=U)},14224:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a,c=[],l=!1,h=-1;function u(){l&&a&&(l=!1,a.length?c=a.concat(c):h=-1,c.length&&d())}function d(){if(!l){var e=s(u);l=!0;for(var t=c.length;t;){for(a=c,c=[];++h<t;)a&&a[h].run();h=-1,t=c.length}a=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},25105:(e,t)=>{["\\|\\|","\\&\\&",";;","\\|\\&","\\<\\(",">>",">\\&","[&;()|<>]"].join("|");for(var n=0;n<4;n++)(Math.pow(16,8)*Math.random()).toString(16)},72366:(e,t,n)=>{"use strict";var r=n(90672),i=n.n(r),o=n(43034),s=n.n(o),a=n(16992),c=n.n(a),l=n(30919),h=n.n(l),u=n(15671),d=n.n(u),p=n(37253),f=n.n(p),g=n(96656),_={};_.styleTagTransform=f(),_.setAttributes=h(),_.insert=c().bind(null,"head"),_.domAPI=s(),_.insertStyleElement=d(),i()(g.Z,_),g.Z&&g.Z.locals&&g.Z.locals},90672:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},s=[],a=0;a<e.length;a++){var c=e[a],l=r.base?c[0]+r.base:c[0],h=o[l]||0,u="".concat(l," ").concat(h);o[l]=h+1;var d=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==d)t[d].references++,t[d].updater(p);else{var f=i(p,r);r.byIndex=a,t.splice(a,0,{identifier:u,updater:f,references:1})}s.push(u)}return s}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var o=r(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var c=r(e,i),l=0;l<o.length;l++){var h=n(o[l]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}o=c}}},16992:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},15671:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},30919:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},43034:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},37253:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{"use strict";n(94654),n(18238);var e=n(55481),t=n.n(e);n(25105),n(72366),"\n  ".concat(t().magenta.bold("PeerJS Utility"),"\n\n  Usage:\n    peer <command> <args> [options]\n\n  To set your ID (default is UUID):\n    peer id --id myfirstdevice\n\n  Default Connection Broker:\n    ").concat(t().bold("Kernel.get('peerjs', 'server-host')")," if set, or ").concat(t().bold("0.peerjs.com"),"\n\n  Commands:\n    call <peer-id> [--video] [--audio]                                     Call a peer with media streams\n    chat <peer-id>                                                         Open a text chat with a peer\n    connect <peer-id>                                                      Connect to a peer\n    id                                                                     Display your peer ID\n    list                                                                   List available peers\n    send <peer-id> [--text] [--text-file] [--json] [--json-file]           Send a raw message\n    screen <peer-id>                                                       Share your screen with a peer\n    upload <peer-id> [--file]                                              Upload a file to a peer\n\n  Options:\n    --debug                                                                Debug level ({0},1,2,3)\n    --file                                                                 Path of the file to upload\n    --help                                                                 Print this help message\n    --id                                                                   Set your peer ID\n    --json                                                                 JSON string to send\n    --json-file                                                            Path to JSON file to send\n    --server-host                                                          Set the peerjs broker host\n    --server-key                                                           Server API key (for 0.peerjs.com)\n    --server-path                                                          Set the peerjs broker path {/}\n    --server-port                                                          Set the peerjs broker port {443}\n    --text                                                                 Text message to send\n    --text-file                                                            Path to the text file to send\n    --version                                                              Print the version information\n"),Boolean,Boolean,Boolean,Boolean,Boolean,globalThis.Kernel.i18n.t})()})();
//# sourceMappingURL=peer.js.map